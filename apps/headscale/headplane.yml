# Headplane server configuration
server:
  host: "0.0.0.0"
  port: 3000
  cookie_secret: "COOKIE_SECRET" # openssl rand -base64 30
  cookie_secure: true

# Headscale integration
headscale:
  url: "http://headscale:8080"
  # public_url: "https://headscale.jobot-services.com"
  config_path: "/etc/headscale/config.yaml"
  config_strict: true

# Integration settings
integration:
  # Agent provides node info (version, OS, connectivity)
  agent:
    enabled: false
    # pre_authkey: "your-preauth-key"

  # Docker integration for signaling headscale on DNS changes
  docker:
    enabled: true
    container_label: "me.tale.headplane.target=headscale"
    socket: "unix:///var/run/docker.sock"

  kubernetes:
    enabled: false
    pod_name: "headscale"
    validate_manifest: true

  proc:
    enabled: false

# OIDC authentication (Authentik)
oidc:
  issuer: "https://authentik.jobot-services.com/application/o/headscale/"
  client_id: "your-headscale-client-id"
  client_secret: "your-headscale-client-secret"

  # Must match Headscale client_id for user subject consistency
  # Generate by running docker exec -it headscale \headscale apikeys create
  headscale_api_key: "your-headscale-api-key"

  redirect_uri: "https://headscale.jobot-services.com/admin/oidc/callback"
  disable_api_key_login: false
  token_endpoint_auth_method: "client_secret_post"
  user_storage_file: "/var/lib/headplane/users.json"
